function flv_playerEvent(a,b){var c=G_PLAYER_INSTANCE;var d=c.dapctrl;var e=G_PLAYER_ERROR;if(a=="onbuffering"){if(c.lastEvent!="onSeek"&&c.lastEvent!="onopen"){c.bufferTimes++;c.bufferBeginTime=parseInt((new Date).valueOf());c.isBufferCalc=true}var f=c.lastEvent;c.setLastEvent("onbuffering",2);c.isBuffering=true;c.bufferStartTimes++;c.bufferStartTime=parseInt((new Date).valueOf());c.bufferStartPos=c.updatePlayPos();var g=c.subStart+c.getPlayPosition();try{d.Put("dPlayPos",g);d.Put("sPlayerOp","bufstart")}catch(h){}if(f=="onplaying"){if(c.playMode!="DC"&&c.getBufferLength()>30){if(!e.bufferError){e.bufferError=true;e.playCheck("012")}}else if(c.playMode!="DC"&&c.getAvailablePlayTime()>90){if(!e.bufferError){e.bufferError=true;e.playCheck("013")}}}if(f=="onBuffering"){e.dump("014",true)}}else if(a=="onplaying"){e.bufferError=false;if(c.playMode!="DC"){c.bufferEndTime=parseInt((new Date).valueOf());c.trace("bufend__ ...urlToPlayTime="+(c.bufferEndTime-c.setURLTime)/1e3+", bufferTime="+(c.bufferEndTime-c.bufferStartTime)/1e3);if(c.isBuffering&&c.bufferStartPos>0){d.Put("dPlayPos",c.bufferStartPos);d.Put("sPlayerOp","bufend")}if(!c.isFixFirstBuf){c.isFixFirstBuf=true}}c.isBuffering=false;c.setLastEvent("onplaying",3);c.timeStampObj.play=parseInt((new Date).valueOf());e.errorHasPlay=true}else if(a=="onPause"){try{c.updatePlayPos();d.Put("sPlayerOp","pause")}catch(h){}c.setLastEvent("onPause",6)}else if(a=="onSeek"){c.setLastEvent("onSeek",4);try{var g=c.subStart+b;d.Put("dPlayPos",g);d.Put("sPlayerOp","seek")}catch(h){}}else if(a=="onopen"){c.setLastEvent("onopen",1)}else if(a=="onStop"){V.stopPos=G_PLAYER_INSTANCE.getPlayPosition();var i="a"}else if(a=="onEnd"){c.setLastEvent("onEnd",7);G_PLAYER_INSTANCE.close();G_PLAYER_INSTANCE.closeNetStream()}else if(a=="autoChangeQulity"){c.setLastEvent("autoChangeQulity",8);c.setNoticeMsg("智能切换清晰度已完成")}else if(a=="onErrorInfo"){var j=G_PLAYER_INSTANCE.getPlayPosition();var k=new Date;var l=k.getHours()+":"+k.getMinutes();if(typeof G_PLAYER_INSTANCE.playTimes[l]=="undefined"){G_PLAYER_INSTANCE.playTimes[l]=1}var m=G_PLAYER_INSTANCE.flashOpenParam[0];c.fireEvent("onErrorStat",typeof b=="undefined"?"1":b);if(G_PLAYER_INSTANCE.playTimes[l]>3){G_PLAYER_INSTANCE.close();G_PLAYER_INSTANCE.closeNetStream();G_PLAYER_INSTANCE.flv_showErrorInfo();setTimeout(function(){if(typeof b=="undefined"){var a="播放异常，请检查网络连接或重试！";var d=""}else{var a="播放异常，请检查网络连接或重试！";var d=b}c.fireEvent("onErrorExit",d,a)},50)}else{var n=G_PLAYER_INSTANCE.flashOpenParam;if(n[4].sliceType==0){n[4].start=j}else{n[4].start=j}n[3]=1;n[5]=0;setTimeout(function(){if(b==204){G_PLAYER_INSTANCE.seek(j)}else{G_PLAYER_INSTANCE.close();G_PLAYER_INSTANCE.closeNetStream();G_PLAYER_INSTANCE.flashopen.apply(G_PLAYER_INSTANCE,n)}G_PLAYER_INSTANCE.playTimes[l]++},50)}}else if(a=="onRePlay"){G_PLAYER_INSTANCE.close();G_PLAYER_INSTANCE.closeNetStream();var n=G_PLAYER_INSTANCE.flashOpenParam;n[4].start=0;n[5]=0;n[3]=1;G_PLAYER_INSTANCE.flashopen.apply(G_PLAYER_INSTANCE,n)}else if(a=="onShowBufferTip"){}c.fireEvent(a);c.trace("flv_playerEvent",a)}var G_PLAYER_INSTANCE=null;(function(){if(typeof a=="undefined"){var a=new Object}if(typeof a.util=="undefined"){a.util=new Object}if(typeof a.SWFObjectUtil=="undefined"){a.SWFObjectUtil=new Object}a.SWFObject=function(b,c,d,e,f,g,h,i,j,k,l){if(!document.createElement||!document.getElementById){return}this.DETECT_KEY=l?l:"detectflash";this.skipDetect=true;this.params=new Object;this.variables=new Object;this.attributes=new Array;if(b){this.setAttribute("swf",b)}if(c){this.setAttribute("id",c)}if(d){this.setAttribute("width",d)}if(e){this.setAttribute("height",e)}if(f){this.setAttribute("version",new a.PlayerVersion(f.toString().split(".")))}this.installedVer=a.SWFObjectUtil.getPlayerVersion(this.getAttribute("version"),h);if(g){this.addParam("bgcolor",g)}else{this.addParam("wmode","transparent")}var m=i?i:"high";this.addParam("quality",m);this.setAttribute("useExpressInstall",h);this.setAttribute("doExpressInstall",false);var n=j?j:window.location;this.setAttribute("xiRedirectUrl",n);this.setAttribute("redirectUrl","");if(k){this.setAttribute("redirectUrl",k)}};a.SWFObject.prototype={setAttribute:function(a,b){this.attributes[a]=b},getAttribute:function(a){return this.attributes[a]},addParam:function(a,b){this.params[a]=b},getParams:function(){return this.params},addVariable:function(a,b){this.variables[a]=b},getVariable:function(a){return this.variables[a]},getVariables:function(){return this.variables},getVariablePairs:function(){var a=new Array;var b;var c=this.getVariables();for(b in c){a.push(b+"="+c[b])}return a},getSWFHTML:function(){var a="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","PlugIn")}a='<embed type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'"';a+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';var b=this.getParams();for(var c in b){a+=[c]+'="'+b[c]+'" '}var d=this.getVariablePairs().join("&");if(d.length>0){a+='flashvars="'+d+'"'}a+=' pluginspage="http://www.macromedia.com/go/getflashplayer"/>'}else{if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","ActiveX")}a='<object id="'+this.getAttribute("id")+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0">';a+='<param name="movie" value="'+this.getAttribute("swf")+'" />';var e=this.getParams();for(var c in e){a+='<param name="'+c+'" value="'+e[c]+'" />'}var f=this.getVariablePairs().join("&");if(f.length>0){a+='<param name="flashvars" value="'+f+'" />'}a+="</object>"}return a},write:function(b){if(this.getAttribute("useExpressInstall")){var c=new a.PlayerVersion([6,0,65]);if(this.installedVer.versionIsValid(c)&&!this.installedVer.versionIsValid(this.getAttribute("version"))){this.setAttribute("doExpressInstall",true);this.addVariable("MMredirectURL",escape(this.getAttribute("xiRedirectUrl")));document.title=document.title.slice(0,47)+" - Flash Player Installation";this.addVariable("MMdoctitle",document.title)}}if(this.skipDetect||this.getAttribute("doExpressInstall")||this.installedVer.versionIsValid(this.getAttribute("version"))){var d=typeof b=="string"?document.getElementById(b):b;d.innerHTML=this.getSWFHTML();return true}else{if(this.getAttribute("redirectUrl")!=""){document.location.replace(this.getAttribute("redirectUrl"))}}return false}};a.SWFObjectUtil.getPlayerVersion=function(b,c){var d=new a.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var e=navigator.plugins["Shockwave Flash"];if(e&&e.description){d=new a.PlayerVersion(e.description.replace(/([a-z]|[A-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."))}}else{try{var f=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");for(var g=15;g>6;g--){try{f=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+g);d=new a.PlayerVersion([g,0,0]);break}catch(h){}}}catch(h){}if(b&&d.major>b.major){return d}if(!b||(b.minor!=0||b.rev!=0)&&d.major==b.major||d.major!=6||c){try{d=new a.PlayerVersion(f.GetVariable("$version").split(" ")[1].split(","))}catch(h){}}}return d};a.PlayerVersion=function(a){this.major=parseInt(a[0])!=null?parseInt(a[0]):0;this.minor=parseInt(a[1])||0;this.rev=parseInt(a[2])||0};a.PlayerVersion.prototype.versionIsValid=function(a){if(this.major<a.major){return false}if(this.major>a.major){return true}if(this.minor<a.minor){return false}if(this.minor>a.minor){return true}if(this.rev<a.rev){return false}return true};a.util={getRequestParameter:function(a){var b=document.location.search||document.location.hash;if(b){var c=b.indexOf(a+"=");var d=b.indexOf("&",c)>-1?b.indexOf("&",c):b.length;if(b.length>1&&c>-1){return b.substring(b.indexOf("=",c)+1,d)}}return""}};if(Array.prototype.push==null){Array.prototype.push=function(a){this[this.length]=a;return this.length}}var b=a.util.getRequestParameter;var c=a.SWFObject;window.SWFObject=a.SWFObject})();var argumentsToArray=function(a){var b=[];for(var c=0;c<a.length;c++)b.push(a[c]);return b};Function.prototype.delayApply=function(a,b,c){var d=this;return setTimeout(function(){d.apply(b,c)},a)};Function.prototype.delayCall=function(a,b){return this.delayApply(a,b,argumentsToArray(arguments).slice(2))};var KankanObj=XL_CLOUD_FX_INSTANCE.Class.extend({init:function(){},mStatSend:function(a){var b=new Image(1,1);b.src=a},trace:function(a,b){if(b=="onProgress"){return false}var c="kankan=====DEBUG:"+a+","+b;try{if(this.showDebugFlag&&a.indexOf("downloadProgress.bufferEnd")==-1)console.log(c)}catch(d){}},getParameter:function(a){var b=new RegExp("[?&]"+a+"=([^&#]+)","g");try{var c=b.exec(this.getLoc())}catch(d){}if(null!=c){return decodeURIComponent(c[1])}else{return null}},rand:function(a,b){var c=b-a;var d=Math.random();return a+Math.round(d*c)},getLoc:function(){try{return document.location.href}catch(a){}},$:function(a){return document.getElementById(a)},getCookie:function(a){try{var b=document.cookie.match(new RegExp("(^"+a+"| "+a+")=([^;]*)"))==null?"":decodeURIComponent(RegExp.$2);if(b!=""){return b}else{return""}}catch(c){return""}},time:function(){return(new Date).getTime()},pageRefresh:function(){var a=window.location.href;var b=a.split("#");if(window.location.href.indexOf("?")>0){window.location=b[0]+"&rd="+this.time()}else{window.location=b[0]+"?rd="+this.time()}return true},$C:function(a){return document.createElement(a)},$P:function(a,b){return b?b.appendChild(a):document.body.appendChild(a)}});var KankanEventObj=KankanObj.extend({init:function(){this._super();this.attachEvent=this.addEventListener;this.detachEvent=this.removeEventListener;this.fireEvent=this.dispatchEvent},addEventListener:function(a,b,c,d){if(!this[b])this[b]=[];if(!(this[b]instanceof Array))return false;for(var e=0;e<this[b].length;e++)if(this[b][e].o==a&&this[b][e].f==c)return true;this[b].push({o:a,f:c,t:d});return true},removeEventListener:function(a,b,c){if(!this[b]||!(this[b]instanceof Array))return false;for(var d=0;d<this[b].length;d++)if(this[b][d].o==a&&(this[b][d].f==c||!c)){this[b].splice(d,1);if(0==this[b].length)delete this[b];return true}return false},dispatchEvent:function(a){if(!this[a]||!(this[a]instanceof Array))return false;var b=[this].concat(argumentsToArray(arguments));var c=this[a].slice(0);for(var d=0;d<c.length;d++)if(typeof c[d].t=="number")c[d].f.delayApply(c[d].t,c[d].o,b);else c[d].f.apply(c[d].o,b);return true}});var KKPlayerError=KankanEventObj.extend({init:function(){this._super();this.errorMap={200:'该文件播放须用迅雷看看播放器，<a href="###" onclick="V.install();return false;">点击安装</a>，安装成功之后刷新此页面即可播放',"003":"Flash 初始化失败,清除浏览器缓存,再刷新页面重试","004":'检测到Flash Player控件异常,请先安装最新版本Flash Player。<a href="http://www.longkou.de/" target="_blank">龙口</a>',"005":'检测到迅雷看看高清播放组件退出，请<font color="#097BB3"><u><a href="javascript:G_PLAYER_INSTANCE.pageRefresh()" target="_self">刷新</a></u></font>页面重试|',"006":"抱歉，您当前使用的浏览器与迅雷看看不兼容，请使用IE浏览器","009":'检测到Flash Player控件异常,请先安装最新版本Flash Player。<a href="http://wo.longkou.de/" target="_blank">龙口天气预报</a>',100:"没找到播放地址,请选择播放其他节目|"};this.lastError="";this.count=0;this.eStatUrl="http://kkpgv.xunlei.com/?u=kankan_mp4_logic_error";this.dErrorMap={10002:"临时文件打开失败，请刷新页面重试",10003:"磁盘空间不足，请首先关闭迅雷或看看高清播放组件，再刷新页面重试,龙口论坛 http://bbs.longkou.de/",63533:"播放地址错误，请刷新页面重试",30004:"无法创建或写缓存，请关闭迅雷或看看高清播放组件，再重新刷新页面",30006:'检测到您的磁盘剩余空间不足，无法保存在线点播所产生的临时文件，\n建议清理出剩余空间大于1G后再刷新页面重试观看。<font color="#FF6600">错误码：30006</font>\n或者升级至最新版本，不再出现 <font color="#097BB3"><u><a href="javascript:G_PLAYER_INSTANCE.windowOpen("http://xmp.down.sandai.net/kankan/KankanSetup.exe")" target="_self">立即升级</a></u></font>',31124:'检测到您的磁盘剩余空间不足，无法保存在线点播所产生的临时文件，\n建议清理出剩余空间大于1G后再刷新页面重试观看。<font color="#FF6600">错误码：31124</font>\n或者升级至最新版本，不再出现 <font color="#097BB3"><u><a href="javascript:G_PLAYER_INSTANCE.windowOpen("http://xmp.down.sandai.net/kankan/KankanSetup.exe")" target="_self">立即升级</a></u></font>',1002:"数据错误，请重试播放",1003:"数据错误，请重试播放",1004:"播放模式错误，请刷新页面重试",101:"接收媒体数据失败，请确认网络连接正常，再重试播放",62535:"接收媒体数据超时，请确认网络连接正常，再刷新页面重试",62533:"系统调用错误，请刷新页面重试",65518:"启动迅雷流媒体服务失败，请确认迅雷或看看高清播放组件是否正常安装。或者尝试重启计算机。",65517:"连接迅雷流媒体服务失败，版本可能过低，请安装最新版本的迅雷看看高清播放组件",65516:"与协议版本不符合，请关闭迅雷或看看高清播放组件后，刷新页面重试",65515:'<font size="14">启用高清播放组件失败，建议您升级更新高清播放组件或刷新页面重试。<font color="#FF6600">错误码：65515</font>\n<u><a href="javascript:G_PLAYER_ERROR.changeInstallPlay()" target="_self">点击更新高清播放组件</a></u>  <u><a href="javascript:G_PLAYER_INSTANCE.pageRefresh()" target="_self">刷新页面重试</a></u></font></font>',65514:"未安装迅雷流媒体服务，请安装迅雷看看高清播放组件",65513:"迅雷流媒体服务已经退出，请重启迅雷或看看高清播放组件后，再刷新页面重试。或者尝试重启计算机",65512:"你安装的迅雷版本过低，不支持此服务，请安装最新版本的迅雷看看高清播放组件",65511:"你安装的迅雷非官方版本，不支持此服务，请安装最新版本的迅雷看看高清播放组件",65510:"获取服务端口失败，请刷新页面重试",65509:'<font size="14">启用高清播放组件失败，建议您升级更新高清播放组件或刷新页面重试。<font color="#FF6600">错误码：65509</font>\n<font color="#097BB3"><u><a href="javascript:G_PLAYER_ERROR.changeInstallPlay()" target="_self">点击更新高清播放组件</a></u>  <u><a href="javascript:G_PLAYER_INSTANCE.pageRefresh()" target="_self">刷新页面重试</a></u></font></font>',65519:"获取服务端口失败，请刷新页面重试",4183:"高清播放组件读取数据失败，请刷新页面重试或更换其他影片观看",4503:"高清播放组件读取数据失败，请刷新页面重试或更换其他影片观看",4504:"高清播放组件读取数据失败，请刷新页面重试或更换其他影片观看",4531:"网络问题，请检查网络是否连接正常，或刷新页面重试",4544:"无法播放此影片，请刷新页面重试或更换其他影片观看",4557:"高清播放组件异常，请刷新页面重试或更换其他影片观看"};this.debugBuffer=[];this.debugShowed=false;this.feedbackParam=""},reInit:function(){this.dapctrlError=false;this.bufferError=false},dump:function(a,b,c){this.count++;this.trace("------ERROR-CODE:"+a);if(a=="000"||a=="001"||a=="002"||a=="003"||a=="004"||a=="006"||a=="007"||a=="009"){this.stat.delayCall(0,this,a,false)}else{this.stat.delayCall(0,this,a,true,c)}if(b){return false}if(typeof this.errorMap[a]!="undefined"){return true}return false},showError:function(a,b){var c=G_PLAYER_INSTANCE;var d=b.split("|");if(a!=200&&typeof c!="undefined"&&c&&typeof c.showError!="undefined"){c.showError(escape(d[0]),escape(d[1]))}else{this.showOnPage(d[0],a)}},stat:function(a,b,c){var d=this.lastError;this.lastError=a;var e=G_PLAYER_INSTANCE;if(b){if(!c){c=""}var f={sid:0,ctype:0,ver:0,lastError:d,lastEvent:"",uid:0};var g=this.getClientType;f.ctype=g.ctype;f.ver=g.ver;if(e){f.sid=e.sid;f.lastEvent=e.lastEvent}f.uid=this.getCookie("KANKANWEBUID");var h=this.eStatUrl+"&u1="+a+"&u2="+encodeURIComponent(this.getLoc())+"&u3="+f.sid+"&u4="+f.lastEvent+"&u5="+f.ctype+"_"+f.ver+"&u6="+f.uid+"&u7="+f.lastError+"&u8="+this.count+"&u9="+c+"&rd="+this.time()}else{var h=this.eStatUrl+"&u1="+a+"&rd="+this.time()}this.mStatSend(h)},playCheck:function(a){if(!this.errorDetectDelay){this.errorHasPlay=false;this.errorDetectDelay=true;this.playCheckDelay.delayCall(6e4,G_PLAYER_ERROR,a)}},playCheckDelay:function(a){var b=G_PLAYER_INSTANCE;if(!this.errorHasPlay){this.dump("T"+a,true,b.getEventQueue()+"_"+b.getBufferBugInfo()+"_"+b.getPlayPosition())}this.errorHasPlay=false;this.errorDetectDelay=false}});var KKPlayerInit=KankanEventObj.extend({init:function(){this._super();this.playerLoaded=false;this.flashAvailable=false;this.playerPath="/flash/PlayerCtrlFlv_2.71.pan.swf";this.dapctrl=null;this.dapctrlBackup=false;this.checkPlayerTime=0;this.bufferStartTime=0;this.bufferEndTimes=0;XL_CLOUD_FX_INSTANCE.init(this)},printObject:function(a,b,c,d,e,f){var g=this.getCookie("player_mode");this.trace("printObject start");this.playerPath+="?v=2.0";if(typeof SWFObject=="undefined"){G_PLAYER_ERROR.dump("000");this.printObjectManually(a,b,c,d)}else{var h=new SWFObject(this.playerPath,"PlayerCtrl",c,d,"9","#000000","js/expressInstall.swf");h.addParam("allowScriptAccess","always");h.addParam("allowFullScreen","true");if(this.verFlashplayer&&this.verFlashplayer[0]>=10&&this.verFlashplayer[1]>=2&&g==5){}else{}h.addParam("wmode","transparent");h.addParam("quality","high");if(f){h.addParam("flashVars",f)}h.skipDetect=false;if(!h.write(a)){this.fireEvent("onFlashError");return false}}this.checkPlayer.delayCall(0,this)},printObjectManually:function(a,b,c,d){if(this.isIE){var e="";e+='<object width="'+c+'" height="'+d+'" id="PlayerCtrl" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codeBase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" >';e+='<PARAM NAME="_cx" VALUE="25664"><PARAM NAME="_cy" VALUE="13917"><PARAM NAME="FlashVars" VALUE="">';e+='<PARAM NAME="Movie" VALUE="'+this.playerPath+'"><PARAM NAME="Src" VALUE="'+this.playerPath+'"><PARAM NAME="WMode" VALUE="Window">';e+='<PARAM NAME="Play" VALUE="0"><PARAM NAME="Loop" VALUE="-1"><PARAM NAME="Quality" VALUE="High"><PARAM NAME="SAlign" VALUE="LT">';e+='<PARAM NAME="Menu" VALUE="0"><PARAM NAME="Base" VALUE=""><PARAM NAME="AllowScriptAccess" VALUE="always"><PARAM NAME="Scale" VALUE="NoScale">';e+='<PARAM NAME="DeviceFont" VALUE="0"><PARAM NAME="EmbedMovie" VALUE="0"><PARAM NAME="BGColor" VALUE="000000"><PARAM NAME="SWRemote" VALUE="">';e+='<PARAM NAME="MovieData" VALUE=""><PARAM NAME="SeamlessTabbing" VALUE="1"><PARAM NAME="Profile" VALUE="-1"><PARAM NAME="ProfileAddress" VALUE="">';e+='<PARAM NAME="ProfilePort" VALUE="830362444"><PARAM NAME="AllowNetworking" VALUE="all"><PARAM NAME="AllowFullScreen" VALUE="true">';e+="</object>";this.$(a).innerHTML=e}else{var e="";e+='<object width="'+c+'" height="'+d+'" id="PlayerCtrl" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codeBase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" >';e+='<embed src="'+this.playerPath+'" quality="high" pluginspage="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash" type="application/x-shockwave-flash" width="'+c+'" height="'+d+'"></embed>';e+="</object>";this.$(a).innerHTML=e}},checkPlayer:function(){if(this.checkPlayerTime>=800){this.fireEvent("onLoadFlashError");return}this.checkPlayerTime++;var a=this.$("PlayerCtrl");if(typeof a.flv_setPlayeUrl=="undefined"){this.checkPlayer.delayCall(50,this)}else{G_PLAYER_INSTANCE=new KKPlayerInstance;if(!G_PLAYER_INSTANCE){this.checkPlayer.delayCall(50,this);return false}this.fireEvent("onload");this.playerLoaded=true;this.trace("init success");try{if(!G_PLAYER_INIT.dapctrlBackup){G_PLAYER_INSTANCE.dapctrl.attachEvent("State",G_PLAYER_INSTANCE.dapCtrlHandler)}else{G_PLAYER_INSTANCE.dapctrl.onState=G_PLAYER_INSTANCE.dapCtrlHandler}}catch(b){}}}});var KKPlayerInstance=KankanEventObj.extend({init:function(){this._super();this.dapctrl=G_PLAYER_INIT.dapctrl;this.pobject=this.$("PlayerCtrl");this.paramobj=[];this.qualitystr="000";this.playMode=null;this.setURLTime=0;this.bufferStart=10;this.title="";this.pauseObj=null;this.isBuffering=false;this.isFixFirstBuf=false;this.bufferStartPos=0;this.vlength=0;this.qualitytype=0;this.submovieid=0;this.lastEvent="init";this.qualitySwitch=false;this.qualitySwitchStart=0;this.timeStampObj={open:0,fopen:0,play:0};this.sid=0;this.eventQueue=[0,0,0,0,0,0,0,0,0,0];this.preDownloadUrl={sUrl:"",rUrl:""};this.isServer=false;this.skipStart=0;this.skipEnd=0;this.bufferTimes=0;this.totleByte=0;this.totleTime=0;this.start=0;this.flashOpenParam={};this.playTimes={}},close:function(){this.playMode="";try{this.pobject.flv_close()}catch(a){}this.setLastEvent("init",0);this.preDownloadUrl={sUrl:"",rUrl:""}},pause:function(){this.pobject.flv_pause()},play:function(){this.pobject.flv_play()},stop:function(){this.pobject.flv_stop();this.preDownloadUrl={sUrl:"",rUrl:""}},fpstop:function(){this.pobject.flv_stop()},getPlayPosition:function(){return this.pobject.getPlayProgress(true)},getBufferProgress:function(){return this.pobject.getBufferProgress()},setNoticeMsg:function(a,b,c,d,e){if(parseInt(b)<=0)b=15;if(!c){this.pobject.flv_setNoticeMsg(a,false,parseInt(b),1);c=null}this.pobject.flv_setNoticeMsg(a,false,parseInt(b),1,c,d,e)},getBufferedPos:function(){return this.pobject.getBufferEnd()},flashopen:function(url,isServer,urlObj,autoplay,param,ischange){if(this.qualitySwitch){this.qualityFlashopen(url);return false}if(typeof this.playTimes[url]=="undefined")this.playTimes[url]=1;else this.playTimes[url]++;this.flashOpenParam=arguments;this.bufferTimes=0;var paramobj=eval('[{url:"",start:0,autoplay:1,quality:0,qualitystr:"000",qualitytype:0,subStart:0,subEnd:0,title:"",vcut:0,submovieid:0,skipMovieHeadTime:0,skipMovieEndTime:0,streamtype:0,posterUrl:"",totleByte:0,totleTime:0,sliceTime:0}]');paramobj[0].url=url;paramobj[0].start=parseInt(this.start);paramobj[0].autoplay=autoplay;paramobj[0].quality=parseInt(this.quality);paramobj[0].qualitystr=this.qualitystr;paramobj[0].title=this.title;paramobj[0].vcut=this.vcut;paramobj[0].qualitytype=this.qualitytype;paramobj[0].submovieid=this.submovieid;paramobj[0].posterUrl=this.poster;if(isServer){paramobj[0].totalByte=param.totalByte;paramobj[0].totalTime=param.totalTime;paramobj[0].totleTime=param.totalTime;paramobj[0].sliceTime=12e3;paramobj[0].sliceType=param.sliceType;paramobj[0].start=0;if(typeof param.start!="undefined"){paramobj[0].start=parseInt(param.start);if(isNaN(paramobj[0].start))paramobj[0].start=0;if(paramobj[0].start<0)paramobj[0].start=0}paramobj[0].format=param.format}if(urlObj){paramobj[0].jsonObj=urlObj;if(autoplay){paramobj[0].autoplay=autoplay}else{paramobj[0].autoplay=2}}if(isServer){this.isServer=true;paramobj[0].streamtype=1;paramobj[0].packageUrl=this.packageUrl}else{this.isServer=false;paramobj[0].streamtype=0}if(this.subEnd>this.subStart){paramobj[0].subStart=this.subStart;paramobj[0].subEnd=this.subEnd}paramobj[0].skipMovieHeadTime=this.skipStart;paramobj[0].skipMovieEndTime=this.skipEnd;this.paramobj=paramobj;this.pobject.setBufferTime(this.bufferStart);if(ischange==1){this.pobject.flv_setChangeUrl(paramobj)}else{this.pobject.flv_setPlayeUrl(paramobj)}G_PLAYER_INSTANCE.setURLTime=parseInt((new Date).valueOf());this.timeStampObj.fopen=parseInt((new Date).valueOf())},showError:function(a,b){try{this.pobject.flv_stop()}catch(c){}if(b=="")var b="如果还无法观看，请查看<font color='#097BB3'><u><a href='javascript:G_PLAYER_INSTANCE.windowOpen(\"http://www.xunlei.com/help/\")' target='_self'>常见问题</a></u></font> 或 <font color='#097BB3'><u><a href='javascript:G_PLAYER_INSTANCE.windowOpen(\"http://www.xunlei.com/help/feedback.html"+G_PLAYER_ERROR.feedbackParam+"\")' target='_self'>反馈给我们</a></u></font>！";this.pobject.flv_handleError(a,b)},getPlayStatus:function(){var a=this.pobject.getPlayStatus();if(a==-1){return"init"}else if(a==0){return"playing"}else if(a==1){return"pause"}else if(a==2){return"stop"}else if(a==3){return"replay"}else{return"undefined"}},getDownloadSpeed:function(){return this.pobject.getDownloadSpeed()},getDownloadProgress:function(){var a=this.dapctrl;var b=a.Get("DPLAYDURATION");var c=a.Get("iDownRatio");if(b>0){var d=(b-this.subStart)/this.getDuration()*1e4;if(d>=1e4||c>=1e4){return 1e4}else if(d<0){return 0}else{return parseInt(d)}}else{if(this.vcut==1&&this.subEnd>0&&this.vlength>0){var e=a.Get("iDownRatio");var d=(e*this.vlength/1e4-this.subStart)/(this.subEnd-this.subStart)*1e4;if(d>1e4){return 1e4}else if(d<0){return 0}else{return parseInt(d)}}else{return a.Get("iDownRatio")}}},updatePlayPos:function(){var a=this.subStart+this.getPlayPosition();return a},destory:function(){try{this.pobject=null}catch(a){}},setSpolierXml:function(a){this.pobject.flv_setSpolierXml(a)},setADParams:function(a){this.pobject.flv_setADParams(a)},setPlayPosition:function(a){this.pobject.flv_setSeekPos(a)},cutStreamLink:function(){this.pobject.cutStreamLink()},closeAdPlaying:function(){this.pobject.flv_closeAdPlaying()},getDuration:function(){return this.pobject.getDuration()},getDownloadPos:function(){if(this.pobject.getDuration()>0&&this.getDownloadProgressAll()>0){return this.pobject.getDuration()*this.getDownloadProgressAll()/1e4}else{return 0}},closeNotice:function(){return this.pobject.flv_closeNotice()},closeNoticeCallback:function(){this.fireEvent("onCloseNotice")},getErrorInfo:function(){return this.pobject.getErrorInfo()},changeBufferTime:function(a){if(a>0){this.trace("player changeBufferTime ="+a);return this.pobject.flv_changeBufferTime(a)}},setIsSkipMovieHead:function(a){return this.pobject.flv_setIsSkipMovieHead(a)},setIsAutoChangeQuality:function(a){return this.pobject.flv_setIsAutoChangeQuality(a)},getPlayerConfig:function(){return this.pobject.flv_getSetStatusInfo()},getBufferLength:function(){return this.pobject.flv_getBufferLength()},setLastEvent:function(a,b){this.lastEvent=a;if(b>0){this.eventQueue.unshift(b);this.eventQueue=this.eventQueue.slice(0,10)}},getEventQueue:function(){return this.eventQueue.join("-")},getBufferBugInfo:function(){return this.pobject.flv_getBufferBugInfo()},getFlashVer:function(){return this.pobject.getVariable("$version").split(" ")[1].split(",")},getStageVideoInfo:function(){return this.pobject.flv_stageVideoInfo()},setFullScreen:function(a){return this.pobject.flv_setFullScreen(a)},setFullScreenBanner:function(a,b){var c={url:a,peerid:b};c.url=a;c.peerid=b;this.pobject.flv_setFullscreenBanner(c);this.trace("player set bannerAD url="+c.url+", peerid="+c.peerid)},setCornerAD:function(a){this.pobject.flv_setCornerObject(a)},closeCorner:function(){this.pobject.flv_closeCorner()},getStickPlayMessage:function(){return this.pobject.flv_getStickPlayMessage()},getCurrentFps:function(){return this.pobject.flv_getNsCurrentFps()},setIsChangeQuality:function(a){return this.pobject.flv_setIsChangeQuality(a)},playWithInstall:function(){return this.pobject.flv_playWithInstall()},flvExternalCommand:function(a,b){return this.pobject.flv_externalCommand(a,b)},closeNetStream:function(){return this.pobject.flv_closeNetConnection()},getFormats:function(){this.fireEvent("onGetFormats",this,"flash")},setFormats:function(a){return this.pobject.flv_showFormats(a)},setFormatsCallback:function(a,b){this.fireEvent("onSetFormats",this,"flash",a,b)},setFormatCallback:function(a,b){this.fireEvent("onSetFormats",this,"flash",a,b)},showBufferTip:function(a){return this.pobject.flv_showBufferTip(a)},seek:function(a){return this.pobject.flv_seek(a)},getBytes:function(){return this.pobject.flv_getStreamBytesLoaded()},openPlayList:function(){this.fireEvent("openPlayListEvent",this)},showDebug:function(){this.showDebugFlag=true},setCaptionList:function(a){this.pobject.flv_setCaptionList(a)},setCaptionParam:function(a){this.pobject.flv_setCaptionParam(a)},setToolBarEnable:function(a){this.pobject.flv_setToolBarEnable(a)},windowOpen:function(a){try{this.dapctrl.Put("iADShowMode",1);this.dapctrl.Put("sOpenAdURL",a)}catch(b){window.open(a)}},setFileList:function(a,b,c){this.pobject.flv_setBTFileList(a,b,c)},playOtherFail:function(a){this.pobject.flv_playOtherFail(a)},setFeeParam:function(a){this.pobject.flv_setFeeParam(a)},setShareParam:function(a,b){this.pobject.flv_setShareLink(a,b)},getTimePlayed:function(){return this.pobject.flv_getTimePlayed()}});var G_PLAYER_ERROR=new KKPlayerError;var G_PLAYER_INIT=new KKPlayerInit